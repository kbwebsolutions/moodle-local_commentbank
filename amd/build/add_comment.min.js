define(["jquery","core/config"],function(a,b){return{init:function(c,d,e){function f(c){var d=a.Deferred(),e={action:"get_course_assignments",courseid:c},f=b.wwwroot+"/local/commentbank/rest.php";return a.ajax({method:"GET",url:f,data:e,success:function(b){d.resolve(b).then(function(b){var c=a("#id_assignments");Object.keys(b.result).forEach(function(a){c.append(new Option(b.result[a].name,b.result[a].id))}),a("select#id_assignments").val(a("input[name=assignmentid]").val()),a("input[name=assignmentid]").val(0)})},error:function(a){var b=JSON.parse(a.responseText.substring(0,a.responseText.length-4)).error;alert(b)}}),d}a("select#id_coursecategory").closest("#autoselects").children(0).unwrap(),a("select#id_coursecategory").closest(".fitem").addClass("hidden"),a("select#id_course").closest(".fitem").addClass("hidden"),a("select#id_assignments").closest(".fitem").addClass("hidden");var g={CONTEXT_SYSTEM:10,CONTEXT_COURSECAT:40,CONTEXT_COURSE:50,CONTEXT_MODULE:70};"edit"!=c&&"delete"!=c||(a("input[id^='id_editmode_']").not('[id$="0"]').click(function(){a("select#id_context").prop("disabled",!1),a("select#id_course").prop("disabled",!1),a("select#id_assignments").prop("disabled",!1)}),e==g.CONTEXT_COURSECAT&&(a("select#id_coursecategory").closest(".fitem").addClass("hidden"),a("select#id_coursecategory").value=d),e==g.CONTEXT_COURSE&&(a("select#id_course").closest(".fitem").addClass("hidden"),a("select#id_assignments").closest(".fitem").addClass("hidden"),a("select#id_course").parent(0).value=d),e==g.CONTEXT_MODULE&&(a("select#id_course").closest(".fitem").removeClass("hidden"),a("select#id_assignments").closest(".fitem").removeClass("hidden"),f(a("select#id_course").val()),a("select#id_context").prop("disabled",!0),a("select#id_course").prop("disabled",!0),a("select#id_assignments").prop("disabled",!0))),a("#id_context").css({"max-width":"fit-content"}),a("#id_context").change(function(){var b=a(this).children("option:selected").val();b==g.CONTEXT_COURSECAT&&(a("select#id_course").parent(0).closest(".fitem").addClass("hidden"),a("select#id_coursecategory").closest(".fitem").removeClass("hidden"),a("select#id_assignments").closest(".fitem").addClass("hidden")),b==g.CONTEXT_COURSE&&(a("select#id_course").closest(".fitem").removeClass("hidden"),a("select#id_coursecategory").closest(".fitem").addClass("hidden"),a("select#id_assignments").closest(".fitem").addClass("hidden")),b==g.CONTEXT_SYSTEM&&(a("select#id_course").closest(".fitem").addClass("hidden"),a("select#id_coursecategory").closest(".fitem").addClass("hidden"),a("select#id_assignments").closest(".fitem").addClass("hidden")),b==g.CONTEXT_MODULE&&(a("select#id_course").closest(".fitem").removeClass("hidden"),a("select#id_coursecategory").closest(".fitem").addClass("hidden"),f(a("select#id_course").val()),a("select#id_course").prepend(new Option("No Selection","0")).val(0))}),a("#id_course").change(function(){var b=a(this).children("option:selected").val(),c=a("#id_assignments");c.empty(),c.append(new Option("No Selection","0")),c.val(0),a("select#id_context").val()==g.CONTEXT_MODULE&&a("select#id_assignments").closest(".fitem").removeClass("hidden"),f(b)}),a("#id_assignments").change(function(){a("input[name=assignmentid]").val(a("select#id_assignments").val())})}}});